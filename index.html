
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Zetascan - API Reference - v2.0</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;php&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="php">php</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#api-introduction" class="toc-h1 toc-link" data-title="API Introduction">API Introduction</a>
          </li>
          <li>
            <a href="#developer-library" class="toc-h1 toc-link" data-title="Developer library">Developer library</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#api-key" class="toc-h2 toc-link" data-title="Authentication">API key</a>
                  </li>
                  <li>
                    <a href="#ip-authentication" class="toc-h2 toc-link" data-title="Authentication">IP authentication</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#api-overview" class="toc-h1 toc-link" data-title="API Overview">API Overview</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#query-formats" class="toc-h2 toc-link" data-title="API Overview">Query formats</a>
                  </li>
                  <li>
                    <a href="#score-calculation" class="toc-h2 toc-link" data-title="API Overview">Score calculation</a>
                  </li>
                  <li>
                    <a href="#test-cases" class="toc-h2 toc-link" data-title="API Overview">Test Cases</a>
                  </li>
                  <li>
                    <a href="#error-handling" class="toc-h2 toc-link" data-title="API Overview">Error handling</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#http-format" class="toc-h1 toc-link" data-title="HTTP Format">HTTP Format</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#response-headers" class="toc-h2 toc-link" data-title="HTTP Format">Response headers</a>
                  </li>
                  <li>
                    <a href="#error-handling-2" class="toc-h2 toc-link" data-title="HTTP Format">Error handling</a>
                  </li>
                  <li>
                    <a href="#multiple-items" class="toc-h2 toc-link" data-title="HTTP Format">Multiple items</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#text-format" class="toc-h1 toc-link" data-title="Text Format">Text Format</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#format" class="toc-h2 toc-link" data-title="Text Format">Format</a>
                  </li>
                  <li>
                    <a href="#error-handling-3" class="toc-h2 toc-link" data-title="Text Format">Error handling</a>
                  </li>
                  <li>
                    <a href="#multiple-items-2" class="toc-h2 toc-link" data-title="Text Format">Multiple items</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#json-format" class="toc-h1 toc-link" data-title="JSON Format">JSON Format</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#json-response" class="toc-h2 toc-link" data-title="JSON Format">JSON response</a>
                  </li>
                  <li>
                    <a href="#error-handling-4" class="toc-h2 toc-link" data-title="JSON Format">Error handling</a>
                  </li>
                  <li>
                    <a href="#multiple-items-3" class="toc-h2 toc-link" data-title="JSON Format">Multiple items</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#jsonx-format" class="toc-h1 toc-link" data-title="JSONx Format">JSONx Format</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#jsonx-response" class="toc-h2 toc-link" data-title="JSONx Format">JSONx response</a>
                  </li>
                  <li>
                    <a href="#query-parameters" class="toc-h2 toc-link" data-title="JSONx Format">Query Parameters</a>
                  </li>
                  <li>
                    <a href="#bot" class="toc-h2 toc-link" data-title="JSONx Format">Bot</a>
                  </li>
                  <li>
                    <a href="#sinkhole" class="toc-h2 toc-link" data-title="JSONx Format">Sinkhole</a>
                  </li>
                  <li>
                    <a href="#web-server-compromises" class="toc-h2 toc-link" data-title="JSONx Format">Web-Server Compromises</a>
                  </li>
                  <li>
                    <a href="#web-server-attacks" class="toc-h2 toc-link" data-title="JSONx Format">Web-Server Attacks</a>
                  </li>
                  <li>
                    <a href="#miscellaneous" class="toc-h2 toc-link" data-title="JSONx Format">Miscellaneous</a>
                  </li>
                  <li>
                    <a href="#unknown" class="toc-h2 toc-link" data-title="JSONx Format">Unknown</a>
                  </li>
                  <li>
                    <a href="#smtp" class="toc-h2 toc-link" data-title="JSONx Format">SMTP</a>
                  </li>
                  <li>
                    <a href="#error-handling-5" class="toc-h2 toc-link" data-title="JSONx Format">Error handling</a>
                  </li>
                  <li>
                    <a href="#multiple-items-4" class="toc-h2 toc-link" data-title="JSONx Format">Multiple items</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#fqdn-queries" class="toc-h1 toc-link" data-title="FQDN Queries">FQDN Queries</a>
          </li>
          <li>
            <a href="#dnswl-data-format" class="toc-h1 toc-link" data-title="DNSWL data format">DNSWL data format</a>
          </li>
          <li>
            <a href="#browser-access" class="toc-h1 toc-link" data-title="Browser access">Browser access</a>
          </li>
          <li>
            <a href="#dns-api" class="toc-h1 toc-link" data-title="DNS API">DNS API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#lookup-access" class="toc-h2 toc-link" data-title="DNS API">Lookup access</a>
                  </li>
                  <li>
                    <a href="#domain-query" class="toc-h2 toc-link" data-title="DNS API">Domain query</a>
                  </li>
                  <li>
                    <a href="#direct-access" class="toc-h2 toc-link" data-title="DNS API">Direct access</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#dns-response-codes" class="toc-h1 toc-link" data-title="DNS Response codes">DNS Response codes</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#txt-format" class="toc-h2 toc-link" data-title="DNS Response codes">TXT format</a>
                  </li>
                  <li>
                    <a href="#a-aaaa-ptr-format" class="toc-h2 toc-link" data-title="DNS Response codes">A, AAAA, PTR format</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#data-sources" class="toc-h1 toc-link" data-title="Data Sources">Data Sources</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#ip-addresses-sources" class="toc-h2 toc-link" data-title="Data Sources">IP Addresses sources</a>
                  </li>
                  <li>
                    <a href="#domains-sources" class="toc-h2 toc-link" data-title="Data Sources">Domains sources</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#code-snippets" class="toc-h1 toc-link" data-title="Code snippets">Code snippets</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#python" class="toc-h2 toc-link" data-title="Code snippets">Python</a>
                  </li>
                  <li>
                    <a href="#node-js" class="toc-h2 toc-link" data-title="Code snippets">Node.js</a>
                  </li>
                  <li>
                    <a href="#javascript" class="toc-h2 toc-link" data-title="Code snippets">Javascript</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://zetascan.com/signup/?lang=en'>Sign Up for a Developer Key</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='api-introduction'>API Introduction</h1>
<blockquote>
<p>API endpoint:</p>
</blockquote>
<pre class="highlight plaintext"><code>https://api.zetascan.com/
</code></pre>
<p>The Zetascan Query Services <code>&quot;ZQS&quot;</code> was created to facilitate the real-time lookup of IP and Domain threat data into various applications and services. Currently there are dozens of various domain and IP data-feeds available to developers. Many of these feeds are available free of charge and some are paid for services when minimum query levels are exceeded. In addition, there are 2 main problems with trying to incorporate multiple data feed into a solution:</p>

<ol>
<li><p>The overlap between data feed providers in the content listed (IPs &amp; URIs), and</p></li>
<li><p>The absence of normalised meta-data related to the IPs or Domains.</p></li>
</ol>

<p>Because of the above, many developers asked if we could do something to reduce the complexity related to accessing and using threat data as part of their applications - ZQS is our solution. We are introducing a <em>more elegant API for developers</em>, with an affordable pricing model to match.</p>

<p>To start, <a href="https://zetascan.com/signup/?lang=en">signup for a developer key</a> and begin to integrate ZQS into your web-apps and mobile applications. A free-trial for 5,000 API queries is available for a 60-day period.</p>
<h1 id='developer-library'>Developer library</h1>
<p>To ease implementation Zetascan provides developer libraries in various languages. This provides a straightforward way to add ZQS support into your application.</p>

<ul>
<li><a href="https://github.com/zetascan/go-zetascan">Go library</a>

<ul>
<li>HTTP, text, JSON and JSONx support</li>
<li>Support for DNS lookups</li>
<li>Example code provided</li>
</ul></li>
<li><a href="https://github.com/zetascan/php-zetascan">PHP library</a>

<ul>
<li>HTTP, text, JSON and JSONx support </li>
</ul></li>
<li>Python and NodeJS library, coming soon.</li>
</ul>
<h1 id='authentication'>Authentication</h1>
<p>Authentication to ZQS can be provided via an API key, or specifying your servers&#39; static IP address.</p>
<h3 id='api-key'>API key</h3><pre class="highlight shell tab-shell"><code>curl https://api.zetascan.com/?key<span class="o">=</span>YOURAPIKEY
</code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="s1">'https://api.zetascan.com/?key=YOURAPIKEY'</span><span class="p">);</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>
<blockquote>
<p>Make sure to replace <code>YOURAPIKEY</code> with your API key.</p>
</blockquote>

<p>To query the ZQS an API key can be specified as an argument. No API key? <a href="https://zetascan.com/signup/?lang=en">Signup and receive</a> a key instantly. </p>

<p>ZQS uses API keys to allow access to the service, and expects the API key to be included in all requests, if IP authentication is not provided.</p>

<aside class="notice">
Zetascan only accepts the API key using SSL/https. If using the http interface without SSL, IP authentication must be used.
</aside>
<h3 id='ip-authentication'>IP authentication</h3>
<p>Alternatively, authentication to ZQS can be allowed by providing your servers IP address via the <a href="https://zetascan.com/dashboard/?lang=en">Zetascan dashboard</a>.</p>
<h1 id='api-overview'>API Overview</h1><h2 id='query-formats'>Query formats</h2>
<blockquote>
<p>Query end-points include 4 formatting options:</p>
</blockquote>
<pre class="highlight plaintext"><code>https://api.zetascan.com/v2/check/http/
</code></pre><pre class="highlight plaintext"><code>https://api.zetascan.com/v2/check/text/
</code></pre><pre class="highlight plaintext"><code>https://api.zetascan.com/v2/check/json/
</code></pre><pre class="highlight plaintext"><code>https://api.zetascan.com/v2/check/jsonx/
</code></pre>
<p>You can issue requests to our endpoints from virtually any operating system or programming language. REST queries are extremely fast and provide the richest set of information about an item.</p>

<p>Each client has unique access key, generated by the system. You need to provide this key, if querying from an unregistered static IP address.</p>

<p>There are four types of REST queries:</p>

<ul>
<li>HTTP</li>
<li>Text</li>
<li>JSON</li>
<li>JSONx</li>
</ul>

<p>The type of desired query is passed in the HTTP request.</p>
<h2 id='score-calculation'>Score calculation</h2>
<p>ZQS provides two scoring mechanisms to grade an IP or domain-name for abuse, anti-spam measures, and trustworthiness. </p>

<p>A negative score, like <code>-0.1</code>, means that an item was matched on a known trusted white-list.</p>

<p>If a score is <code>0</code>, the item is not found within Zetascan and can be considered neutral.</p>

<p>A score between <code>0 - 1.0</code> is a rating on the specified domain or IP address. Scores above <code>0.35</code> should be considered as spam or fraudulent.</p>

<p>Reference the <a href="#data-sources">data sources</a> chapter for more information on feeds used to calculate the scores.</p>
<h3 id='webscore'>webscore</h3>
<p>Webscore is returned by all query methods, which is used to determine a score for integrating your web-application, mobile-app or protecting your application infrastructure.</p>
<h3 id='score'>score</h3>
<p>Score is also returned by all query methods, and it used to determine a specified IP or domain-name for anti-spam abuse via SMTP, useful for MTA and spam-filters. This score takes into consideration email abuse, and uses a different algorithm from the webscore key.</p>
<h2 id='test-cases'>Test Cases</h2><h3 id='ip-addresses'>IP Addresses</h3>
<p>We provide four IPv4 and four IPv6 addresses, which will always return the same answers. Use these for testing and development:</p>

<ul>
<li><code>127.9.9.1</code> - returning as if found in SBL, XBL &amp; CBL</li>
<li><code>127.9.9.2</code> - returning as if in PBL</li>
<li><code>127.9.9.3</code> - returning as if in SBL subnet</li>
<li><code>127.9.9.4</code> - good IP, found in DNSWL, also contains White List data</li>
<li><code>::1, ::2, ::3, ::4</code> - returning as above for IPv6, except for ::2, which is found both in PBL and DNSWL (example of a false positive)</li>
</ul>
<h3 id='domains'>Domains</h3>
<p>We provide two testing domains:</p>

<ul>
<li><p><code>baddomain.org</code> - returns as if found in all domain DB&#39;s: DBL, and all URIBL</p></li>
<li><p><code>okdomain.org</code> - returns as if found in a White List.</p></li>
</ul>
<h2 id='error-handling'>Error handling</h2>
<p>When querying ZQS, the following error-codes will be returned if the query or authentication failed. Each query format (Text, HTTP, JSON/JSONx) will embed any error messages in the returned data. Examples on handling errors will be provided for each query format example.</p>
<h3 id='error-codes'>Error codes</h3>
<p><code>1</code> - HTTP 404 - Invalid request - the REST path was wrong, e.g. /v2/check/gson/domain.com. Appears in the message body and in the
x-zetascan-error header. This is the only error that appears like that,
others appears in the specified format as per the documentation.</p>

<p><code>2</code> - HTTP 404 - Missing IP/Domain argument</p>

<p><code>3</code> - HTTP 404 - Failed to parse query&#39;s item</p>

<p><code>4</code> - HTTP 403 - HTTPS required to supply API key</p>

<p><code>5</code> - HTTP 403 - Not authorized (request to invalid host, route, port or method, or API method not supported)</p>

<p><code>6</code> - HTTP 403 - Not authorized (request from invalid IP address or with invalid key)</p>

<p><code>7</code> - HTTP 403 - Wrong API Key supplied</p>

<p><code>8</code> - HTTP 404 - HTTP GET request required for queries</p>

<p><code>9</code> - HTTP 403 - Query limit exceeded</p>
<h1 id='http-format'>HTTP Format</h1><pre class="highlight shell tab-shell"><code>curl -i https://api.zetascan.com/v2/check/http/baddomain.org?key<span class="o">=</span>YOURAPIKEY

HTTP/1.1 200 OK
Content-Type: text/plain; <span class="nv">charset</span><span class="o">=</span>utf-8
x-zetascan-items: baddomain.org
x-zetascan-status: success
x-zetascan-score: 1
x-zetascan-sources: DBL;RED;GREY;GOLD;BLACK
x-zetascan-wl: null
x-zetascan-time: 1500970900
x-zetascan-webscore: 0.6
x-zetascan-fromParent: null
</code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="s1">'https://api.zetascan.com/v2/check/http/baddomain.org?key=YOURAPIKEY'</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="c1">// Request headers only
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span> 
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_NOBODY</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

<span class="c1">// Lookup the HTTP status code
</span><span class="nv">$status</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>

<span class="c1">// Check status codes for a match
</span><span class="k">if</span><span class="p">(</span><span class="nv">$status</span> <span class="o">==</span> <span class="mi">204</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"No match in Zetascan blacklist or white-list"</span><span class="p">;</span>

<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$status</span> <span class="o">==</span> <span class="mi">403</span><span class="p">)</span>   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"Request forbidden, check API-key or IP registered"</span><span class="p">;</span>

<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>

    <span class="nv">$headers</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>    
    <span class="nv">$data</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="nv">$response</span><span class="p">);</span>

    <span class="nv">$headers</span><span class="p">[</span><span class="s1">'status'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="c1">// Take the HTTP response out, first element
</span>    <span class="nb">array_shift</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

    <span class="c1">// Build an array for our headers
</span>    <span class="k">foreach</span><span class="p">(</span><span class="nv">$data</span> <span class="k">as</span> <span class="nv">$part</span><span class="p">){</span>
        <span class="nv">$middle</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">":"</span><span class="p">,</span><span class="nv">$part</span><span class="p">);</span>
        <span class="nv">$headers</span><span class="p">[</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$middle</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$middle</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="c1">// Display the score if blacklisted, otherwise if a whitelist
</span>    <span class="k">if</span><span class="p">(</span> <span class="nv">$headers</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="nx">zetascan</span><span class="o">-</span><span class="nx">score</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nv">$headers</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="nx">zetascan</span><span class="o">-</span><span class="nx">webscore</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>    <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Item blacklisted, score "</span> <span class="o">.</span> <span class="nv">$headers</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="nx">zetascan</span><span class="o">-</span><span class="nx">score</span><span class="p">]</span> <span class="o">.</span> <span class="s2">" webscore "</span> <span class="o">.</span> <span class="nv">$headers</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="nx">zetascan</span><span class="o">-</span><span class="nx">webscore</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Item white-listed"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>HTTP returns very simple response - found or not, via HTTP response code. If found, the response will be 200 (OK).</p>

<p>If the item is not present in any black-list/white-list, then the answer will be 204 (No Content).</p>

<p>Additional information about the item is found in the response headers. </p>
<h3 id='response-headers'>Response headers</h3>
<p>If the query matches, the following HTTP headers will be supplied for additional information.</p>

<blockquote>
<p>Example HTTP header response:</p>
</blockquote>
<pre class="highlight plaintext"><code>x-zetascan-items:querydomain.org
x-zetascan-score:1
x-zetascan-webscore:0.6
x-zetascan-sources:DBL;RED;GREY;GOLD;BLACK
x-zetascan-time:1500970900
x-zetascan-wl:null
x-zetascan-status:success
</code></pre>
<table><thead>
<tr>
<th>HTTP Header</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>x-zetascan-items</td>
<td>The argument used to query ZQS</td>
</tr>
<tr>
<td>x-zetascan-score</td>
<td>The score returned for the query, used for MTA and SMTP anti-spam measures</td>
</tr>
<tr>
<td>x-zetascan-webscore</td>
<td>The score returned for the query, used for Web and application anti-abuse. Note the differences between web-score and score, see the score calculation for more information.</td>
</tr>
<tr>
<td>x-zetascan-sources</td>
<td>A list of sources the query is obtained from, delimitated by a semicolon. See the <a href="#domains-sources">source references</a> for more information.</td>
</tr>
<tr>
<td>x-zetascan-time</td>
<td>EPOCH time of response for the query</td>
</tr>
<tr>
<td>x-zetascan-wl</td>
<td>A list of sources matched if the query is listed in a white-list.</td>
</tr>
<tr>
<td>x-zetascan-status</td>
<td>Returns &quot;success&quot;, otherwise &quot;forbidden&quot; or &quot;error&quot;</td>
</tr>
</tbody></table>
<h3 id='error-handling-2'>Error handling</h3>
<blockquote>
<p>Example HTTP error response:</p>
</blockquote>
<pre class="highlight plaintext"><code>x-zetascan-errorCode:7
x-zetascan-errorMessage:Wrong API Key
x-zetascan-status:forbidden
</code></pre>
<table><thead>
<tr>
<th>HTTP Header</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>x-zetascan-errorCode</td>
<td>The returned error-code. If present, the query has failed.</td>
</tr>
<tr>
<td>x-zetascan-errorMessage</td>
<td>A detailed explanation of the failure</td>
</tr>
<tr>
<td>x-zetascan-status</td>
<td>Returns &quot;forbidden&quot; if authentication denied, or &quot;error&quot; for all other error codes.</td>
</tr>
</tbody></table>
<h2 id='multiple-items'>Multiple items</h2>
<blockquote>
<p>http://api.zetascan.com/v2/check/http/127.9.9.1,127.9.9.2</p>
</blockquote>
<pre class="highlight plaintext"><code>x-zetascan-items: 127.9.9.1,127.9.9.2
x-zetascan-status: success,success
x-zetascan-score: 0.95,0.2
x-zetascan-sources: XBL;SBL,PBL
x-zetascan-wl: null,null
x-zetascan-time: 1500970900,1500970900
x-zetascan-webscore: 0.6,null
x-zetascan-fromParent: null,null
</code></pre>
<p>You can send multiple items in a single request by comma delimitating each IP or domain. This will speed up the overall time for answering your query.</p>

<p>The HTTP headers will contain a response for each query, comma delimitated in sequence from the query specified.</p>
<h1 id='text-format'>Text Format</h1><pre class="highlight shell tab-shell"><code>curl https://api.zetascan.com/v2/check/text/baddomain.org?key<span class="o">=</span>YOURAPIKEY
</code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="c1">// Text method
</span><span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="s1">'https://api.zetascan.com/v2/check/text/baddomain.org?key=YOURAPIKEY'</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

<span class="c1">// Lookup the HTTP status code
</span><span class="nv">$status</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>

<span class="c1">// Check status codes for a match
</span><span class="k">if</span><span class="p">(</span><span class="nv">$status</span> <span class="o">==</span> <span class="mi">204</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"No match in Zetascan blacklist or white-list"</span><span class="p">;</span>

<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$status</span> <span class="o">==</span> <span class="mi">403</span><span class="p">)</span>   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"Request forbidden, check API-key or IP registered"</span><span class="p">;</span>

<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">// Read the body and split from the specified API formatting
</span>        <span class="nv">$head</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">":"</span><span class="p">,</span> <span class="nv">$response</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="nv">$head</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"error"</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">echo</span> <span class="s2">"An error occurred "</span> <span class="o">.</span> <span class="nv">$head</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

            <span class="nv">$str</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">","</span><span class="p">,</span> <span class="nv">$head</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

            <span class="c1">// $str will contain each field as specified below
</span>            <span class="k">echo</span> <span class="s2">"Blacklist hit =&gt; "</span> <span class="o">.</span> <span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">"Whitelist hit =&gt; "</span> <span class="o">.</span> <span class="nv">$str</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">"Whitelist data =&gt; "</span> <span class="o">.</span> <span class="nv">$str</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">"Score =&gt; "</span> <span class="o">.</span> <span class="nv">$str</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">"WebScore =&gt; "</span> <span class="o">.</span> <span class="nv">$str</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>

            <span class="k">echo</span> <span class="s2">"Sources =&gt; "</span><span class="p">;</span>

            <span class="c1">// List all sources, comma separated
</span>            <span class="k">for</span><span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">echo</span> <span class="nv">$str</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">","</span><span class="p">;</span>
            <span class="p">}</span>

        <span class="p">}</span>

<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
<blockquote>
<p>The above example returns text in the format:</p>
</blockquote>
<pre class="highlight plaintext"><code>baddomain.org:true,false,,1,0.6,dbl,red,gold,grey,black
</code></pre>
<p>TEXT returns space separated blocks of information about the lists where the item is found.</p>

<p>Text example - replace &#39;baddomain.com&#39; with your query - IP or domain:</p>
<h3 id='format'>Format</h3>
<p>Items are separated by space. The format for each item is:</p>

<p><code>item:bool,bool,wldata,score,webscore,source</code></p>

<p>Where:</p>

<ul>
<li><p>the first bool is true, if found in any black or white list.</p></li>
<li><p>the second bool is true, if found in any white list.</p></li>
<li><p>wldata contains the data from the white list (if present)</p></li>
<li><p>score, returns the score used for MTA/anti-spam abuse.</p></li>
<li><p>webscore, the returned score for web/application abuse.</p></li>
<li><p>sources, a comma separated list of which lists the query was matched on.</p></li>
</ul>
<h3 id='error-handling-3'>Error handling</h3>
<p>If an error occurs using the text query, the data returned will contain the an error prefix, followed by an error message, and the specific error-code.</p>

<p>Example authentication error:</p>

<p><code>error:Wrong API Key;7</code></p>

<p>Malformed query:</p>

<p><code>error:Failed to parse query&#39;s item;3</code></p>
<h2 id='multiple-items-2'>Multiple items</h2>
<blockquote>
<p>http://api.zetascan.com/v2/check/text/127.9.9.1,127.9.9.2</p>
</blockquote>
<pre class="highlight plaintext"><code>127.9.9.1:true,false,,0.95,0.6,xbl,sbl 127.9.9.2:true,false,,0.2,0,pbl
</code></pre>
<p>You can send multiple items in a single request by comma delimitating each IP or domain. This will speed up the overall time for answering your query.</p>

<p>The text format, will contain a response for each query, <code>space</code> delimitated.</p>
<h1 id='json-format'>JSON Format</h1><pre class="highlight shell tab-shell"><code>curl https://api.zetascan.com/v2/check/json/baddomain.org?key<span class="o">=</span> YOURAPIKEY
</code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="c1">// PHP example with multi-query support, error checking, and JSON data presented
</span><span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="s1">'https://api.zetascan.com/v2/check/json/baddomain.org,okdomain.org,badquery?key=YOURAPIKEY'</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

<span class="c1">// Lookup the HTTP status code
</span><span class="nv">$status</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>

<span class="c1">// Check status codes for a match
</span><span class="k">if</span><span class="p">(</span><span class="nv">$status</span> <span class="o">==</span> <span class="mi">403</span><span class="p">)</span>   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"Request forbidden, check API-key or IP registered"</span><span class="p">;</span>

<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>

    <span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$response</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

    <span class="c1">// Check for any error messages, auth failure, API-key incorrect, etc.
</span>    <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$json</span><span class="p">[</span><span class="s2">"error"</span><span class="p">][</span><span class="s2">"message"</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"An error occurred "</span> <span class="o">.</span> <span class="nv">$json</span><span class="p">[</span><span class="s2">"error"</span><span class="p">][</span><span class="s2">"message"</span><span class="p">];</span>
    <span class="p">}</span> 

    <span class="c1">// Loop through each response ( multiple queries can be delimitated by a comma)
</span>    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$json</span><span class="p">[</span><span class="s2">"results"</span><span class="p">]);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">echo</span> <span class="s2">"Query =&gt; "</span> <span class="o">.</span> <span class="nv">$json</span><span class="p">[</span><span class="s2">"results"</span><span class="p">][</span><span class="nv">$i</span><span class="p">][</span><span class="s2">"item"</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>

        <span class="c1">// Check for an error message
</span>        <span class="k">if</span><span class="p">(</span><span class="nv">$json</span><span class="p">[</span><span class="s2">"results"</span><span class="p">][</span><span class="nv">$i</span><span class="p">][</span><span class="s2">"error"</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"An error occurred "</span> <span class="o">.</span> <span class="nv">$json</span><span class="p">[</span><span class="s2">"results"</span><span class="p">][</span><span class="nv">$i</span><span class="p">][</span><span class="s2">"error"</span><span class="p">][</span><span class="s2">"message"</span><span class="p">]</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Display the results
</span>        <span class="nb">print_r</span><span class="p">(</span><span class="nv">$json</span><span class="p">[</span><span class="s2">"results"</span><span class="p">][</span><span class="nv">$i</span><span class="p">]);</span>

    <span class="p">}</span>

<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
<blockquote>
<p>Example JSON return string:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"results"</span><span class="p">:[{</span><span class="w">
        </span><span class="s2">"item"</span><span class="p">:</span><span class="s2">"baddomain.org"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"found"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"score"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"webscore"</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span><span class="w">
        </span><span class="s2">"fromSubnet"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sources"</span><span class="p">:</span><span class="w">
            </span><span class="p">[</span><span class="s2">"shDBL"</span><span class="p">,</span><span class="s2">"ubGrey"</span><span class="p">,</span><span class="s2">"ubGold"</span><span class="p">,</span><span class="s2">"ubRed"</span><span class="p">,</span><span class="s2">"ubBlack"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"wl"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"wldata"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"lastModified"</span><span class="p">:</span><span class="mi">1500972200</span><span class="w">
        </span><span class="p">}],</span><span class="w">
    </span><span class="s2">"executionTime"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"success"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>The query will return a JSON response including if the item is found on a black-list/white-list, score, sources, etc. Refer to the table below for each field explanation.</p>

<aside class="notice">
The `found` key will be true, if the item is hit in a black-list or white-list. Test the `wl` condition if the item is contained within a white-list. If the score or webscore value is > 0 and `wl` false, the item is contained in a black-list.
</aside>
<h3 id='json-response'>JSON response</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Item</td>
<td>Query value (IP or domain)</td>
</tr>
<tr>
<td>Found</td>
<td>True/False if matched in a white-list/black-list.</td>
</tr>
<tr>
<td>Score</td>
<td>Score between -0.1 to 1.0 for MTA/Anti-spam abuse. See <a href="#score-calculation">score information</a></td>
</tr>
<tr>
<td>WebScore</td>
<td>Scorebetween 0.1 to 1.0 for Web/application abuse.</td>
</tr>
<tr>
<td>FromSubnet</td>
<td>Will be true, if the IP address was found in a subnet (PBL, SBL)</td>
</tr>
<tr>
<td>Sources</td>
<td>Black-Lists matched from ZQS. <a href="#data-amp-access-methods">See list</a> information.</td>
</tr>
<tr>
<td>Wl</td>
<td>If the item matches a white-list.</td>
</tr>
<tr>
<td>Wldata</td>
<td>White-Lists matched from ZQS. <a href="#data-amp-access-methods">See list</a> information.</td>
</tr>
<tr>
<td>ExecutionTime</td>
<td>Time in ms for server response</td>
</tr>
<tr>
<td>Status</td>
<td>Success or failure</td>
</tr>
</tbody></table>
<h3 id='error-handling-4'>Error handling</h3>
<blockquote>
<p>Example authentication error:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"error"</span><span class="p">:{</span><span class="s2">"message"</span><span class="p">:</span><span class="s2">"Wrong API Key"</span><span class="p">,</span><span class="s2">"errorCode"</span><span class="p">:</span><span class="mi">7</span><span class="p">}}</span><span class="w"> 
</span></code></pre>
<blockquote>
<p>Malformed query:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"results"</span><span class="p">:</span><span class="w">
    </span><span class="p">[{</span><span class="s2">"item"</span><span class="p">:</span><span class="s2">"malformedquery"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error"</span><span class="p">:{</span><span class="w">
        </span><span class="s2">"message"</span><span class="p">:</span><span class="s2">"Failed to parse query's item"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"errorCode"</span><span class="p">:</span><span class="mi">3</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>If an error occurred, the JSON response will return an errorCode, message and status within the JSON object.</p>

<p>It is highly recommended to test against the specified error-codes during implementation. Reference the <a href="#error-handling">error handling</a> section for more information.</p>
<h2 id='multiple-items-3'>Multiple items</h2>
<blockquote>
<p>http://api.zetascan.com/v2/check/json/127.9.9.1,127.9.9.2</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"results"</span><span class="p">:</span><span class="w">
    </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"item"</span><span class="p">:</span><span class="s2">"127.9.9.1"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="p">},{</span><span class="w">
    </span><span class="s2">"item"</span><span class="p">:</span><span class="s2">"127.9.9.2"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="p">}],</span><span class="w">
</span><span class="s2">"executionTime"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
</span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"success"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>You can send multiple items in a single request by comma delimitating each IP or domain. This will speed up the overall time for answering your query.</p>

<p>The JSON format, will contain a response for each query within the <code>results</code> array</p>
<h1 id='jsonx-format'>JSONx Format</h1><pre class="highlight shell tab-shell"><code>curl https://api.zetascan.com/v2/check/jsonx/baddomain.org?key<span class="o">=</span>yourkeygoeshere
</code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="s1">'https://api.zetascan.com/v2/check/jsonx/127.9.9.1?key=YOURAPIKEY'</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

<span class="c1">// Lookup the HTTP status code
</span><span class="nv">$status</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>

<span class="c1">// Check status codes for a match
</span><span class="k">if</span><span class="p">(</span><span class="nv">$status</span> <span class="o">==</span> <span class="mi">403</span><span class="p">)</span>   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"Request forbidden, check API-key or IP registered"</span><span class="p">;</span>

<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>

    <span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$response</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

    <span class="c1">// Display the array
</span>    <span class="nb">print_r</span><span class="p">(</span><span class="nv">$json</span><span class="p">);</span>

    <span class="c1">// Display extended information
</span>    <span class="nb">print_r</span><span class="p">(</span><span class="nv">$json</span><span class="p">[</span><span class="s2">"results"</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">"extended"</span><span class="p">]);</span>

<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>JSONx will return also a JSON document, extended with additional information about the last known activity of an fraudulent IP address. The JSONx format only supports <code>IP addresses</code> and not domain queries.</p>

<aside class="success">
Use JSONx if you require extended information regarding the queried host.
</aside>
<h3 id='jsonx-response'>JSONx response</h3>
<p>Responses include additional information about an IP address with fraudulent activity. This information is found in the &#39;extended&#39; and &#39;emailsdaily&#39; fields, e.g.:</p>
<h3 id='query-parameters'>Query Parameters</h3><pre class="highlight json tab-json"><code><span class="s2">"extended"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"ASNum"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23969"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"route"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.200.0/24"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AU"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"veridas.net"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1486447729"</span><span class="p">,</span><span class="w">

      </span><span class="s2">"reason"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BOT"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"rule"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9904"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sinkhole"</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"conficker"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"104.244.14.252"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"port"</span><span class="p">:</span><span class="w"> </span><span class="s2">"80"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sourceport"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23915"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"destination"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"emailslastday"</span><span class="p">:</span><span class="s2">"123"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre>
<aside class="notice">
The JSONx format will always return an `extended` element, regardless if additional information is available.
</aside>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ASNum</td>
<td>The autonomous system number of the ISP;</td>
</tr>
<tr>
<td>route</td>
<td>The address of the network / subnet from which the activity originated;</td>
</tr>
<tr>
<td>country</td>
<td>The location of the above network;</td>
</tr>
<tr>
<td>domain</td>
<td>The associated domain with the ip address;</td>
</tr>
<tr>
<td>state</td>
<td>Display the state (if available);</td>
</tr>
<tr>
<td>time</td>
<td>The last registered activity timestamp in unix epoch format;</td>
</tr>
<tr>
<td>emailsdaily</td>
<td>Contains the number of detected spam emails in the last 24 hours;</td>
</tr>
</tbody></table>

<p>In addition, the <code>reason</code> object contains additional detection information about the queried IP. Results include:</p>

<ul>
<li>Bot</li>
<li>Sinkhole</li>
<li>Web-Server Compromises</li>
<li>Web-Server Attacks</li>
<li>Miscellaneous</li>
<li>Unknown</li>
</ul>

<p>Details for each response is provided below:</p>
<h3 id='bot'>Bot</h3>
<p>JSONX provides extended information to protect your web-site or mobile application, especially for user signup forms, login and integrations to your application.</p>

<p>JSONX returns a <code>BOT</code> class, which represents one of the following 5 types:</p>
<h3 id='sinkhole'>Sinkhole</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOT"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rule"</span><span class="p">:</span><span class="s2">"9091"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"sinkhole"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"marcher"</span><span class="p">,</span><span class="w"> </span><span class="s2">"source"</span><span class="p">:</span><span class="s2">"216.218.185.162"</span><span class="p">,</span><span class="w"> </span><span class="s2">"port"</span><span class="p">:</span><span class="s2">"80"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sourceport"</span><span class="p">:</span><span class="s2">"n/a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"destination"</span><span class="p">:</span><span class="s2">"onoven.com"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Rule</td>
<td>The detection rule ID</td>
</tr>
<tr>
<td>Type</td>
<td>Sinkhole</td>
</tr>
<tr>
<td>Source</td>
<td>Source IP</td>
</tr>
<tr>
<td>Port</td>
<td>Source Port</td>
</tr>
</tbody></table>
<h3 id='web-server-compromises'>Web-Server Compromises</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOT"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rule"</span><span class="p">:</span><span class="s2">"20062"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"spamlink"</span><span class="p">,</span><span class="w"> </span><span class="s2">"domain"</span><span class="p">:</span><span class="s2">"www.thefashionic.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"source"</span><span class="p">:</span><span class="s2">"1.53.132.24"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"gamut"</span><span class="p">,</span><span class="w"> </span><span class="s2">"link"</span><span class="p">:</span><span class="s2">"https://www.thefashionic.com/wp-content/themes/thevoux-wp/f3ebf56b6f.html"</span><span class="p">,</span><span class="w"> </span><span class="s2">"redirect"</span><span class="p">:</span><span class="s2">"https://targetsale.name"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Rule</td>
<td>The detection rule ID</td>
</tr>
<tr>
<td>Type</td>
<td>Spamlink</td>
</tr>
<tr>
<td>Domain</td>
<td>Spam domain</td>
</tr>
<tr>
<td>Source</td>
<td>Source IP</td>
</tr>
<tr>
<td>Link</td>
<td>Typed link, e.g. as it appears to user</td>
</tr>
<tr>
<td>Redirect</td>
<td>Real link destination</td>
</tr>
</tbody></table>
<h3 id='web-server-attacks'>Web-Server Attacks</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOT"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rule"</span><span class="p">:</span><span class="s2">"9051"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"web server attack"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"commentspammer"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Rule</td>
<td>The detection rule ID</td>
</tr>
<tr>
<td>Type</td>
<td>Web Server Attack</td>
</tr>
<tr>
<td>Name</td>
<td>Extended Information</td>
</tr>
</tbody></table>
<h3 id='miscellaneous'>Miscellaneous</h3>
<p>In this case, attempted user and password are also listed. Note that these fields are not always present.</p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOT"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rule"</span><span class="p">:</span><span class="s2">"9803"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"miscellaneous"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"iotwopbot"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user"</span><span class="p">:</span><span class="s2">"root"</span><span class="p">,</span><span class="w"> </span><span class="s2">"password"</span><span class="p">:</span><span class="s2">"anko"</span><span class="p">,</span><span class="w"> </span><span class="s2">"port"</span><span class="p">:</span><span class="s2">"5358"</span><span class="p">,</span><span class="w"> </span><span class="s2">"source"</span><span class="p">:</span><span class="s2">"198.133.159.133"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sourceport"</span><span class="p">:</span><span class="s2">"53234"</span><span class="p">,</span><span class="w"> </span><span class="s2">"domain"</span><span class="p">:</span><span class="s2">"-"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Rule</td>
<td>The detection rule ID</td>
</tr>
<tr>
<td>Type</td>
<td>Miscellaneous</td>
</tr>
<tr>
<td>Name</td>
<td>Attack name</td>
</tr>
<tr>
<td>User</td>
<td>Attempted username login</td>
</tr>
<tr>
<td>Pass</td>
<td>Attempted password</td>
</tr>
<tr>
<td>Port</td>
<td>Port address</td>
</tr>
<tr>
<td>Source</td>
<td>Source IP</td>
</tr>
<tr>
<td>SourcePort</td>
<td>Source Port address</td>
</tr>
<tr>
<td>Domain</td>
<td>Domain specified</td>
</tr>
</tbody></table>
<h3 id='unknown'>Unknown</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOT"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rule"</span><span class="p">:</span><span class="s2">"3013"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"unknown"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"unknown3013"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"pharmaccccyyy.ca"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Rule</td>
<td>The detection rule ID</td>
</tr>
<tr>
<td>Type</td>
<td>Unknown</td>
</tr>
<tr>
<td>Name</td>
<td>Attack name</td>
</tr>
<tr>
<td>Halo</td>
<td>SMTP Halo specified</td>
</tr>
</tbody></table>
<h2 id='smtp'>SMTP</h2>
<p>If using ZQS for MTA/SMTP security, JSONx provides extended information that can assist with spam detection and email security for end-user mailboxes.</p>
<h3 id='loc'>LOC</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"LOC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"helos as destination server"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>LOC</td>
<td>SMTP &quot;helos&quot; as destination server</td>
</tr>
</tbody></table>
<h3 id='mpd'>MPD</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"MPD"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"helos as multiple unrelated domains"</span><span class="p">,</span><span class="w"> </span><span class="s2">"heloscount"</span><span class="p">:</span><span class="s2">"16"</span><span class="p">,</span><span class="w"> </span><span class="s2">"domainscount"</span><span class="p">:</span><span class="s2">"16"</span><span class="p">,</span><span class="w"> </span><span class="s2">"domains"</span><span class="p">:[</span><span class="s2">"daycoonline.net"</span><span class="p">,</span><span class="w"> </span><span class="s2">"e-apollo.lv"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exitprofit.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"flammhotclicks.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"ftc-i.net"</span><span class="p">,</span><span class="w"> </span><span class="s2">"happyhumans.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"hctc.net"</span><span class="p">,</span><span class="w"> </span><span class="s2">"heronaerospace.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"hi.nl"</span><span class="p">,</span><span class="w"> </span><span class="s2">"hot.dog.cx"</span><span class="p">,</span><span class="w"> </span><span class="s2">"i-love-cats.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"investonline.biz"</span><span class="p">,</span><span class="w"> </span><span class="s2">"kafen.com"</span><span class="p">]}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>MPD</td>
<td>helos as multiple unrelated domains</td>
</tr>
<tr>
<td>heloscount</td>
<td>Number of unique HELO attempts</td>
</tr>
<tr>
<td>domainscount</td>
<td>Number of unique domains on HELO attempts</td>
</tr>
<tr>
<td>domains</td>
<td>JSON array for the domains used for HELO attempts</td>
</tr>
</tbody></table>
<h3 id='never'>Never</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"NEVER"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"forged helos"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"hotmail.com"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>NEVER</td>
<td>Usually forged helos</td>
</tr>
</tbody></table>
<h3 id='misc'>Misc</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"MISC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"specific broken helos"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"device.lan"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>MISC</td>
<td>Usually specific broken helos</td>
</tr>
</tbody></table>
<h3 id='bogus'>Bogus</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOGUS"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"multiple illegal helos"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halos"</span><span class="p">:[</span><span class="s2">"impedibilityz"</span><span class="p">,</span><span class="s2">"recanterp"</span><span class="p">,</span><span class="s2">"stanchedb"</span><span class="p">]}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>BOGUS</td>
<td>Multiple illegal helos</td>
</tr>
<tr>
<td>Halos</td>
<td>JSON array of malformed domains that do not comply with RFC822</td>
</tr>
</tbody></table>
<h3 id='bsip'>BSIP</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BSIP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"illegal helo as IP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"109.242.179.132"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>BSIP</td>
<td>Illegal helo`ing as IP</td>
</tr>
<tr>
<td>Halo</td>
<td>Malformed IP address used to HELO</td>
</tr>
</tbody></table>
<h3 id='ssip'>SSIP</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"SSIP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"illegal helo as own IP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"120.215.192.35"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SSIP</td>
<td>Illegal helo`ing as own IP</td>
</tr>
<tr>
<td>Halo</td>
<td>Source IP address</td>
</tr>
</tbody></table>
<h3 id='lh'>LH</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"SSIP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"illegal helo as own IP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"120.215.192.35"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>* LH</td>
<td>Variations on localhost</td>
</tr>
</tbody></table>
<h3 id='fam'>FAM</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"FAM"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"helos as someone we know they`re not"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rdns"</span><span class="p">:</span><span class="s2">"ppp-93-104-64-20.dynamic.mnet-online.de"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"striker.ottawa.on.ca"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>FAM</td>
<td>Helos as someone we know they`re not</td>
</tr>
<tr>
<td>rdns</td>
<td>Reverse dns of the offending IP</td>
</tr>
</tbody></table>
<h3 id='nohelo'>NOHELO</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"NOHELO"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>NOHELO</td>
<td>Missing Helo</td>
</tr>
</tbody></table>
<h3 id='heli'>HELI</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"HELI"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"special category"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"test654.com"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>HELO</td>
<td>Special category for development purposes.</td>
</tr>
</tbody></table>
<h2 id='error-handling-5'>Error handling</h2>
<p>Error handling for the JSONx query type is the same as the <a href="#error-handling-4">JSON error handling</a> section. </p>
<h2 id='multiple-items-4'>Multiple items</h2>
<p>JSONx support multiple items for a single query, and matches the <a href="#multiple-items-3">JSON multiple-item</a> format.</p>
<h1 id='fqdn-queries'>FQDN Queries</h1><pre class="highlight shell tab-shell"><code>test.baddomain.org;baddomain.org:true,false,,1,0.6,dbl,red,gold,grey,black
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"results"</span><span class="p">:[{</span><span class="s2">"item"</span><span class="p">:</span><span class="s2">"test.baddomain.org"</span><span class="p">,</span><span class="s2">"found"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="s2">"score"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">"webscore"</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span><span class="s2">"fromSubnet"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="s2">"sources"</span><span class="p">:[</span><span class="s2">"shDBL"</span><span class="p">,</span><span class="s2">"ubGrey"</span><span class="p">,</span><span class="s2">"ubGold"</span><span class="p">,</span><span class="s2">"ubRed"</span><span class="p">,</span><span class="s2">"ubBlack"</span><span class="p">],</span><span class="w">
</span><span class="s2">"wl"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="s2">"wldata"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="s2">"lastModified"</span><span class="p">:</span><span class="mi">1500970900</span><span class="p">,</span><span class="s2">"fromParent"</span><span class="p">:</span><span class="s2">"baddomain.org"</span><span class="p">}],</span><span class="s2">"executionTime"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight shell tab-shell"><code>x-zetascan-fromParent: baddomain.org
x-zetascan-items: test.baddomain.org
</code></pre>
<p>We now support sub-domains (FQDN queries). Some BL’s and White Lists have sub-domains listed. If the item is not a direct hit, we will check the parent domain. For example:</p>

<p>https://api.zetascan.com/v2/check/{json/jsonx/http/text}/test.baddomain.org</p>
<h1 id='dnswl-data-format'>DNSWL data format</h1>
<p>The White List data can have two formats:</p>

<p>&quot;wldata&quot;:&quot;1004&quot; or &quot;wldata&quot;:&quot;med;domain.com;id&quot;. 1004 is a special case of so-called auto-promoted IP addresses. Their reputation is based on automatic detection.</p>

<p>The second format has 3 parts: ranking, domain and ID.</p>

<ul>
<li><p>Ranking can be low, med or high;</p></li>
<li><p>Domain is the registered DNS name of the IP address owner;</p></li>
<li><p>ID can be used to find out more information about the organization at https://www.dnswl.org/s/?s=ID</p></li>
</ul>

<p>&quot;wldata&quot; field will have empty string or may be missing, if &quot;wl&quot; is false.</p>
<h1 id='browser-access'>Browser access</h1>
<p>Alternatively, you can test the ZQS using your web-browser. This should be used for test purposes only.</p>

<ul>
<li><p>Point your browser to <a href="https://zetascan.com/query">https://zetascan.com/query</a></p></li>
<li><p>Enter one or more IP addresses or domain names;</p></li>
</ul>

<p>The service will return list of results with details on where the items were found, query time, and calculated score</p>

<p>Note: a 5 second delay is applied to all anonymous user queries. Please register for an API key to remove this delay.</p>

<p>Alternatively, you can issue a query to our API directly from the browser address bar,
by entring the query REST URL:</p>

<p>https://api.zetascan.com/v2/check/text/baddomain.org?key=YOURAPIKEY</p>
<h1 id='dns-api'>DNS API</h1>
<p>ZQS provides an <code>rbldns</code> service that combines the information from all the sources we aggregate.</p>

<p>Multiple query formats are supported, with DNS type records A (ipv4), AAAA (ipv6) and TXT returned.</p>
<h2 id='lookup-access'>Lookup access</h2>
<p>ZQS provides lookup access for a domain or IP address against the <code>*.{APIKEY}.api.zetascan.com</code> FQDN.</p>

<p>This end-point can be used by MTA/SMTP software such as Exim, Postfix, Sendmail and more, for Anti-spam lookups and abuse prevention. Zetascan is a drop-in replacement for existing RBL services to provide a seamless anti-spam service.</p>

<aside class="notice">
Your API-key must be provided as part of the domain-name query.
</aside>
<h2 id='domain-query'>Domain query</h2>
<p>Domain query:</p>

<p> <code>dig A baddomain.org.{key}.api.zetascan.com</code></p>

<p> IPv4 query (213.189.1.4), note the <em>IP must be reversed</em>:</p>

<p><code>dig TXT 4.1.189.213.{key}.api.zetascan.com</code></p>

<p>IPv6 query, note the <em>IP must be reversed and expanded</em>:</p>

<p> <code>dig AAAA 0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.c.b.a.9.8.7.6.5.4.3.2.1.{key}.api.zetascan.com</code></p>

<aside class="notice">
Using the domain query will access your ISP or specified name-server as the resolver. This method may cache results, and performance will vary depending on the upline nameserver.
</aside>
<h2 id='direct-access'>Direct access</h2>
<p>Alternatively, you can query <code>api.zetascan.com</code> directly as a nameserver and retrieve results. Your IP address must be specified within the <a href="https://zetascan.com/dashboard/?lang=en">Zetascan dashboard</a> for access to be granted.</p>

<aside class="notice">
If using an on-premise version of Zetascan replace api.zetascan.com with your provided end-point.
</aside>

<p>Domain query:</p>

<p><code>dig A @api.zetascan.com baddomain.org</code></p>

<p>IPv4 query, note, <em>IP is not</em> reverse formatted.</p>

<p><code>dig TXT @api.zetascan.com 127.9.9.4</code></p>

<p>IPv6 query:</p>

<p><code>dig AAAA @api.zetascan.com ::1</code></p>

<p>PTR IPv4 query (used for reverse IP lookups):</p>

<p><code>dig PTR @api.zetascan.com PTR 1.9.9.127.in-addr.arpa.</code></p>

<p>PTR IPv6 query (used for reverse IP lookups):</p>

<p><code>dig PTR @api.zetascan.com 0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.c.b.a.9.8.7.6.5.4.3.2.1.ip6.arpa</code></p>
<h1 id='dns-response-codes'>DNS Response codes</h1>
<p>When querying ZQS via DNS two formatting options are returned, TXT or (A, AAAA, PTR)</p>
<h2 id='txt-format'>TXT format</h2>
<p>When querying for the DNS TXT type, if the domain/IP is matched, extended information will be returned for the query.</p>

<p>Query:</p>

<p><code>dig TXT @api.zetascan.com 127.9.9.4</code></p>

<p>Return response:</p>

<p><code>127.9.9.4.     0   IN  TXT &quot;127.9.9.4:true,true,10;med;zetascan.com;99999,-0.1,-0.1,dnswl&quot;</code></p>

<p>The response will be the same format as the <a href="#text-format">HTTP text</a>:</p>

<p>The format for each item is:</p>

<p><code>item:bool,bool,wldata,score,webscore,sources</code></p>

<p>Where:</p>

<ul>
<li><p>the first bool is true, if found in any black list.</p></li>
<li><p>the second bool is true, if found in any white list.</p></li>
<li><p>wldata contains the <a href="#DNSWL-data-format">data</a> from the white list (if present)</p></li>
<li><p>score, returns the score used for MTA/anti-spam abuse.</p></li>
<li><p>webscore, the returned score for web/application abuse.</p></li>
<li><p>sources, a comma separated list of which lists the query was matched on.</p></li>
</ul>
<h2 id='a-aaaa-ptr-format'>A, AAAA, PTR format</h2>
<p>When querying via DNS using the A, AAAA, or PTR record types, the following IP addresses will be returned, indicating a match on a specified black-list/white-list, and extended reasons.</p>

<p>Sample dig syntax:</p>

<p><code>dig 4.9.9.127.{APIKEY}.api.zetascan.com A</code></p>

<p>Returned data:</p>

<p><code>4.9.9.127.{APIKEY}.api.zetascan.com. 0 IN A 127.8.10.3</code></p>

<p>The IP returned in the 127.X.X.X format is based on the realtime blacklist <code>RBL</code> syntax, pioneered by anti-spam and MTA software.</p>

<p>Examples for each response type listed below:</p>
<h3 id='127-0-0-x-spamhaus-ip-lists'>127.0.0.x - Spamhaus IP lists</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>127.0.0.10</td>
<td>PBL (Public/residential) IP adddresses, reported by ISP</td>
</tr>
<tr>
<td>127.0.0.11</td>
<td>PBL detected by Spamhaus</td>
</tr>
<tr>
<td>127.0.0.4</td>
<td>XBL Illegal 3rd party exploits, including proxies, worms and trojan exploits</td>
</tr>
<tr>
<td>127.0.0.2</td>
<td>SBL Spamhaus SBL Data</td>
</tr>
<tr>
<td>127.0.0.3</td>
<td>SBL Spamhaus SBL CSS Data</td>
</tr>
<tr>
<td>127.0.0.9</td>
<td>SBL Spamhaus DROP/EDROP Data</td>
</tr>
</tbody></table>
<h3 id='127-0-1-x-spamhaus-domain-lists'>127.0.1.x - Spamhaus Domain Lists</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>127.0.1.2</td>
<td>spam domain</td>
</tr>
<tr>
<td>127.0.1.4</td>
<td>phish domain</td>
</tr>
<tr>
<td>127.0.1.5</td>
<td>malware domain</td>
</tr>
<tr>
<td>127.0.1.6</td>
<td>botnet C&amp;C domain</td>
</tr>
<tr>
<td>127.0.1.102</td>
<td>abused legit spam</td>
</tr>
<tr>
<td>127.0.1.103</td>
<td>abused spammed redirector domain</td>
</tr>
<tr>
<td>127.0.1.104</td>
<td>abused legit phish</td>
</tr>
<tr>
<td>127.0.1.105</td>
<td>abused legit malware</td>
</tr>
<tr>
<td>127.0.1.106</td>
<td>abused legit botnet C&amp;C</td>
</tr>
<tr>
<td>127.0.1.200</td>
<td>Zero reputation domains</td>
</tr>
</tbody></table>
<h3 id='127-1-0-x-uribl-domain-lists'>127.1.0.x - URIBL Domain lists</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>127.1.0.1</td>
<td>Black</td>
</tr>
<tr>
<td>127.1.0.2</td>
<td>Gold</td>
</tr>
<tr>
<td>127.1.0.3</td>
<td>Grey</td>
</tr>
<tr>
<td>127.1.0.4</td>
<td>Red</td>
</tr>
<tr>
<td>127.1.0.5</td>
<td>White - a Domain White List from URIBL</td>
</tr>
</tbody></table>
<h3 id='127-8-0-x'>127.8.0.x</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>127.8.x.1</td>
<td>None, auto-discovered</td>
</tr>
<tr>
<td>127.8.x.2</td>
<td>Low ranking</td>
</tr>
<tr>
<td>127.8.x.3</td>
<td>Medium ranking</td>
</tr>
<tr>
<td>127.8.x.4</td>
<td>High ranking,</td>
</tr>
</tbody></table>

<p>Where the third digit (x) means the type of industry:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>2</td>
<td>Financial services</td>
</tr>
<tr>
<td>3</td>
<td>Email Service Providers</td>
</tr>
<tr>
<td>4</td>
<td>Organisations (both for-profit [i.e. companies] and non-profit)</td>
</tr>
<tr>
<td>5</td>
<td>Service/network providers</td>
</tr>
<tr>
<td>6</td>
<td>Personal/private servers</td>
</tr>
<tr>
<td>7</td>
<td>Travel/leisure industry</td>
</tr>
<tr>
<td>8</td>
<td>Public sector/governments</td>
</tr>
<tr>
<td>9</td>
<td>Media and Tech companies</td>
</tr>
<tr>
<td>10</td>
<td>Some special cases</td>
</tr>
<tr>
<td>11</td>
<td>Education, academic</td>
</tr>
<tr>
<td>12</td>
<td>Healthcare</td>
</tr>
<tr>
<td>13</td>
<td>Manufacturing/Industrial</td>
</tr>
<tr>
<td>14</td>
<td>Retail/Wholesale/Services</td>
</tr>
<tr>
<td>15</td>
<td>Email Marketing Providers</td>
</tr>
<tr>
<td>20</td>
<td>Added through Self Service without specific category</td>
</tr>
</tbody></table>
<h1 id='data-sources'>Data Sources</h1>
<p>Currently we derive our results from several providers, including:</p>

<ul>
<li>Spamhaus</li>
<li>Spamhaus real time stream - DBL, SBL and ZRD </li>
<li>URIBL - different levels of Domain Black Lists and a Domain White List</li>
<li>DNSWL - IP adddresses White List</li>
</ul>

<aside class="notice">
URIBL data can be also used for spam detection, based on URL's (links) inside message body.
</aside>

<p>We also apply internal algorithms for de-duplicating, normalizing and scoring each item in our database, providing a seamless and reliable API end-point for your application.</p>

<p>ZQS queries are answered in less than 1 millisecond, and expect no longer then 10 milliseconds for a query reply.</p>

<p>All our sources are updated at very frequent intervals. We are also using real-time streams, so you may rest assured that you get the latest information from ZQS.</p>

<aside class="notice">
An ZQS virtual appliance is also available for on-premises installation for super-fast access. Please contact us for details about that option.
</aside>
<h2 id='ip-addresses-sources'>IP Addresses sources</h2>
<p>We aggregate data from several data streams: </p>

<ul>
<li>Spamhaus PBL</li>
<li>SBL</li>
<li>XBL</li>
<li>CBL</li>
<li>Spamhaus Real-time stream.</li>
<li>DNSWL IP addresses White List</li>
</ul>

<p>On the other hand, we have also information about White Lists presence of IP address, for example DNSWL.</p>

<p>Unlike other lists, ZQS analyzes the data about each IP address and provides normalized, de-duplicated, and pre-processed information about each IP address, containing internally calculated score (reputation), last modified timestamp, list of BL / WL where the item appears, etc.</p>
<h2 id='domains-sources'>Domains sources</h2>
<p>At this stage we aggregate data from two main Domain providers:</p>

<ul>
<li>Spamhaus DBL and URIBL</li>
<li>Real-time Spamhaus ZRD (Zero Reputation Domains) list.</li>
</ul>

<p>More providers will be added in the near future. Stay tuned!</p>
<h1 id='code-snippets'>Code snippets</h1><h2 id='python'>Python</h2><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">()</span>
<span class="n">session</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="s">'https://api.zetascan.com/v1/check/json/127.9.9.1?key=yourkeygoeshere'</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
  <span class="n">url</span><span class="o">=</span><span class="s">'https://api.zetascan.com/v1/check/json/127.9.9.1?key=yourkeygoeshere'</span>
<span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre><h2 id='node-js'>Node.js</h2><pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">url</span><span class="p">:</span> <span class="s1">'https://api.zetascan.com/v1/check/json/127.9.9.1?key=yourkeygoeshere'</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">);</span>
<span class="p">});</span>
</code></pre><h2 id='javascript'>Javascript</h2><pre class="highlight javascript tab-javascript"><code><span class="nx">jQuery</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://api.zetascan.com/v1/check/json/127.9.9.1?key=yourkeygoeshere'</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s1">'JSON'</span><span class="p">,</span>
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="php">php</a>
          </div>
      </div>
    </div>
  </body>
</html>
